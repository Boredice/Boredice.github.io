<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>二维码生成</title>
<link rel="shortcut icon" href="images/sode.ico">
<style>
::selection {
	color: #00CDCD;
	background: #E9F2FF;
}
::-webkit-scrollbar {
   width: 8px;
   height: 8px;
   background-color: rgba(0,0,0,0.00);
   border-radius: 0px;
}
::-webkit-scrollbar-track {
   border-radius: 0px;
}
::-webkit-scrollbar-thumb {
   border-radius: 0px;
   background-color: rgba(0,0,0,0.2);
}
::-webkit-scrollbar-thumb:hover {
   background-color: rgba(0,0,0,0.3);
}
::-webkit-scrollbar-thumb:active {
   background-color: rgba(0,0,0,0.4);
}
HTML {
	scrollbar-base-color: #D9D9D9;
	scrollbar-track-color: #FFFFFF;
	scrollbar-arrow-color: #D9D9D9;
	scrollbar-shadow-color: #D9D9D9;
}
#qrcode {
	width: 256px;
	height: 256px;
	margin: auto;
	margin-top: 50px;
}
#content {
	text-align: center;
	font-size: 25px;
	word-wrap: break-word;
}
</style>
</head>
<body>
<div id="qrcode"></div>
<p id="content"></p>
</body>
<script src="QRCode.js/qrcode.min.js"></script>
<script>
function toUtf8(str) {    
    var out, i, len, c;    
    out = "";    
    len = str.length;    
    for(i = 0; i < len; i++) {    
        c = str.charCodeAt(i);    
        if ((c >= 0x0001) && (c <= 0x007F)) {    
            out += str.charAt(i);    
        } else if (c > 0x07FF) {    
            out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));    
            out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));    
            out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));    
        } else {    
            out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));    
            out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));    
        }    
    }    
    return out;    
}
var search = window.location.search;
if (search !== "" && search.indexOf("?content=") == 0 && search.length > 9)
{
	try
	{
		var content = search.substring(9);
		content = unspac(content);
		//content = content.replace(/\%hash%/gi, "#");
		alert(content);
		var qrcode = new QRCode("qrcode");
		qrcode.makeCode(content);
		document.getElementById("content").innerHTML = content;
	}
	catch
	{
		alert("发生错误");
		document.getElementById("qrcode").style.height = "0px";
		document.getElementById("content").innerHTML = "无法生成二维码";
	}
}
else
{
	document.getElementById("qrcode").style.height = "0px";
	document.getElementById("content").innerHTML = "无法生成二维码";
}
</script>
</html>